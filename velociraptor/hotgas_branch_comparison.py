import h5py
runs = [
    "L0300N0564_VR121_-8res_Ref",
    "L0300N0564_VR1236_-8res_Ref",
    "L0300N0564_VR130_-8res_Ref",
    "L0300N0564_VR139_-8res_Ref",
    "L0300N0564_VR155_-8res_Ref",
    "L0300N0564_VR187_-8res_Ref",
    "L0300N0564_VR18_-8res_Ref",
    "L0300N0564_VR2272_-8res_Ref",
    "L0300N0564_VR23_-8res_Ref",
    "L0300N0564_VR2414_-8res_Ref",
    "L0300N0564_VR2766_-8res_Ref",
    "L0300N0564_VR2905_-8res_Ref",
    "L0300N0564_VR2915_-8res_Ref",
    "L0300N0564_VR3032_-8res_Ref",
    "L0300N0564_VR340_-8res_Ref",
    "L0300N0564_VR36_-8res_Ref",
    "L0300N0564_VR37_-8res_Ref",
    "L0300N0564_VR470_-8res_Ref",
    "L0300N0564_VR485_-8res_Ref",
    "L0300N0564_VR55_-8res_Ref",
    "L0300N0564_VR666_-8res_Ref",
    "L0300N0564_VR680_-8res_Ref",
    "L0300N0564_VR775_-8res_Ref",
    "L0300N0564_VR801_-8res_Ref",
    "L0300N0564_VR813_-8res_Ref",
    "L0300N0564_VR918_-8res_Ref",
    "L0300N0564_VR93_-8res_Ref",
]

for run in runs:
    with h5py.File(f'Ref_VR_comparison_analysis/{run}.properties', 'r') as h5file:
        print(h5file['/SO_Mass_500_rhocrit'][0], h5file['/SO_Mass_gas_highT_1.000000_times_500.000000_rhocrit'][0])

import numpy as np
hotgas = np.array([
    [10470.871305057703, 1205.65234375],
    [1927.891916915633, 921.9151611328125],
    [9872.485173507852, 1084.92041015625],
    [8633.183958642247, 950.6312255859375],
    [9291.256965612401, 1095.5577392578125],
    [8828.982009165764, 6095.17041015625],
    [29078.733487206104, 3587.639892578125],
    [1108.3664271757639, 255.8397979736328],
    [24184.39161035993, 24138.087890625],
    [983.3178222670924, 46.0886344909668],
    [941.9762313819932, 1119.3660888671875],
    [923.588704945366, 189.53089904785156],
    [832.480116010883, 171.66465759277344],
    [755.9020052794942, 138.40371704101562],
    [5047.376606709973, 1251.7021484375],
    [20805.08007117254, 2755.0859375],
    [23177.980938138247, 3046.862548828125],
    [4353.688247238751, 4379.05859375],
    [4114.599545544591, 352.1247253417969],
    [17266.1955674774, 22866.0859375],
    [3493.1009425301054, 257.8345947265625],
    [3373.0609190197533, 1121.7135009765625],
    [3108.150796639697, 1320.42626953125],
    [2644.130269870263, 2934.63134765625],
    [2958.412372137168, 1791.7364501953125],
    [2670.1405651951495, 3774.460205078125],
    [12785.215476015937, 10296.8837890625],
]).T * 1e10

# Data structure: M500c | M_hotgas500c
master = np.array([
    [10470.778938888074, 1208.31606784],
    [1927.8469759419206, 129.6077684736],
    [9871.424285268791, 1087.3213026304],
    [8632.392450139316, 952.2142773248],
    [9289.475433633304, 1097.5129370624],
    [8830.894004975302, 916.2599694336],
    [29076.002248371067, 3610.5252503552],
    [1108.4000225736427, 47.2563449856],
    [24186.37856320545, 3084.1098993664],
    [983.2513122823614, 46.097006592],
    [941.6456506829347, 38.407471104],
    [923.1080286108768, 43.471781888],
    [832.263188200671, 33.1603247104],
    [756.1849241016072, 25.0338541568],
    [5049.713203476258, 426.8838617088],
    [20804.646156370913, 2770.228740096],
    [23173.333138295755, 3063.8367309824],
    [4346.374498199273, 336.9870819328],
    [4115.264417465431, 352.4420435968],
    [17268.02247236218, 2038.4493600768],
    [3492.9856775677013, 257.9752812544],
    [3372.7856002512513, 275.0908465152],
    [3107.3832307154908, 175.146467328],
    [2644.488432050909, 195.0517428224],
    [2958.403958832529, 266.782244864],
    [2669.971660487996, 184.6446784512],
    [12785.413582786045, 1498.6474684416],
]).T * 1e10

import matplotlib.pyplot as plt
fig, ax = plt.subplots(figsize=(3.321*2, 3.0*2))
ax.scatter(hotgas[0], hotgas[1], marker='.', s=70, c='k', label='hotgas_branch')
ax.scatter(master[0], master[1], marker='.', s=200, facecolors='none', edgecolors='r', label='master')
ax.set_xscale('log')
ax.set_yscale('log')
ax.set_xlabel(r'$M_{500{\rm crit}}\ [{\rm M}_{\odot}]$')
ax.set_ylabel(r'$M_{{\rm gas},500{\rm crit}}\ [{\rm M}_{\odot}]$')
ax.plot(ax.get_xlim(), [lim * 0.15741 for lim in ax.get_xlim()], '--', color='k')

plt.legend()
plt.show()
# fig.savefig('test.png', dpi=400)

    # os.system(f"export OMP_NUM_THREADS=28;VELOCIraptor-STF_hotgas_2020/stf -I 2 -C vrconfig_3dfofbound_subhalos_SO_hydro.cfg -i {run}/snapshots/{run}_2749 -o Ref_VR_comparison_analysis/{run}")

